<%


function drawCharts(spreadsheet,activeSheet) {
var activeSheetName=activeSheet;

var query0 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&headers=-1&merge=COLS&range=A2:A3&pli=1'); 


query0.send(handleQueryResponse0);


var query1_0 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&headers=-1&merge=COLS&range=D6&pli=1'); 

query1_0.send(handleQueryResponse1_0);



var query1 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&headers=-1&merge=COLS&range=D7:H17&pli=1'); 


query1.send(handleQueryResponse1);

}


function handleQueryResponse0(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();

 var datatable = new google.visualization.DataView(response.getDataTable());

  var table = new google.visualization.Table(document.getElementById('globalParamsTable'+activeSheetName));
  table.draw(datatable,{'sort':'disable',cssClassNames: {headerCell: 'googleHeaderCell'}});
}

function handleQueryResponse1_0(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();

 var datatable = new google.visualization.DataView(response.getDataTable());

  var table = new google.visualization.Table(document.getElementById('dataTable1_0'+activeSheetName));
  table.draw(datatable,{'sort':'disable',cssClassNames: {headerCell: 'googleHeaderCell'}});
}

function handleQueryResponse1(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();

 var datatable = new google.visualization.DataView(response.getDataTable());

  var table = new google.visualization.Table(document.getElementById('dataTable1'+activeSheetName));
  table.draw(datatable,{'sort':'disable',cssClassNames: {headerCell: 'googleHeaderCell'}});
}

drawCharts(data.record,activeSheetName);

%>
<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
      <div class="panel-body">
        <div id='textNote'><%print(textNote);%></div>
      </div>
    </div>
</div>
</div>
<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
      <div class="panel-body">
        <div id='globalParamsTable<%=activeSheetName%>'></div>
      </div>
    </div>
</div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-body">

      </div>
    </div>
  </div>
</div>
  <div class="row">
   <div class="col-md-12">
      <div class="panel panel-default">
      <div class="panel-heading">
      </div>
      <div class="panel-body">
          <div id='dataTable1_0<%=activeSheetName%>' >< </div>
          <div id='dataTable1<%=activeSheetName%>' >< </div>
      </div>
</div>
</div>
</div>
</br>



