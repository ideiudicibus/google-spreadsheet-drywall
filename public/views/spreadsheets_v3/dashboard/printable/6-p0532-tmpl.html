<%
function drawCharts(spreadsheet,activeSheet,activeSheetTable) {
var activeSheetName=activeSheet;
var activeSheetTableName=activeSheetTable;

var query0 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&range=C3&pli=1'); 
query0.send(handleQueryResponse0);



var query1 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&range=C4:C15,G4:G15,H4:H15,I4:I15,J4:J15&pli=1'); 
query1.send(handleQueryResponse1);

var query2 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&range=C5:C15,D5:D15&pli=1');
//query2.send(handleQueryResponse2);

//Remissioni Annue
var query3 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&range=C5:C15,G5:G15&pli=1'); 
query3.send(handleQueryResponse3);


var query4 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&range=C5:15,E5:E15&pli=1'); 
//query4.send(handleQueryResponse4);


var query5 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&range=C6:C15,H6:H15,I6:I15,J6:J15&pli=1'); 
query5.send(handleQueryResponse5);

}

function handleQueryResponse5(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

var datatable=response.getDataTable();




//remissioni annui rinominato Esiti


datatable.setColumnLabel(1,"Morti specifiche ");
datatable.setColumnLabel(2,"Epatocarcinomi ");
datatable.setColumnLabel(3,"Trapianti");

var j={"view":{"columns":[{"sourceColumn":0},1,2,3]},"dataTable":datatable,"options":{"hAxis":{"textStyle":{"bold":true,"italic":false},"gridlines":{"color":"#FFFFFF"}},"vAxes":{"0":{"gridlines":{"color":"#FFFFFF"}}},"legend":{"position":"right"},"series":{"0":{"color":"#002060","dataLabel":"value"},"1":{"color":"#8F98A6","dataLabel":"value"},"2":{"color":"#00B0F0","dataLabel":"value"}},"useFirstColumnAsDomain":true,"width":600,"is3D":false,"title":"Esiti","titleTextStyle":{"bold":true,"italic":false},"height":369},"chartType":"ColumnChart"};

google.visualization.drawChart(j, document.getElementById('chart4-p0532')); 

}



function handleQueryResponse4(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var datatable=response.getDataTable();

//costi annui
var j={"view":{"columns":[{"sourceColumn":0},1]},"dataTable":{"rows":[{"c":[{"v":"Anno 0"},{"v":1.2791335951164589E10,"f":"12.791.335.951"}]},{"c":[{"v":"Anno 1"},{"v":5.380036203808472E9,"f":"5.380.036.204"}]},{"c":[{"v":"Anno 2"},{"v":2.6774045808824615E9,"f":"2.677.404.581"}]},{"c":[{"v":"Anno 3"},{"v":1.5400941338379517E9,"f":"1.540.094.134"}]},{"c":[{"v":"Anno 4"},{"v":9.96446698874691E8,"f":"996.446.699"}]},{"c":[{"v":"Anno 5"},{"v":7.06209709727684E8,"f":"706.209.710"}]},{"c":[{"v":"Anno 6-10 media"},{"v":3.6828304241036224E8,"f":"368.283.042"}]},{"c":[{"v":"Anno 11-15 media"},{"v":1.5801283861371917E8,"f":"158.012.839"}]},{"c":[{"v":"Anno 16-20 media"},{"v":7.748894611409149E7,"f":"77.488.946"}]},{"c":[{"v":"Anno 21-25 media"},{"v":4.000059852723465E7,"f":"40.000.599"}]},{"c":[{"v":"Anno 26-30 media"},{"v":2.1564013235095214E7,"f":"21.564.013"}]}],"cols":[{"id":"Col0","label":"","type":"string"},{"pattern":"#,##0","id":"Col1","label":"","type":"number"}]},"chartType":"ColumnChart","options":{"hAxis":{"textStyle":{"bold":true,"italic":false},"gridlines":{"color":"#FFFFFF"}},"vAxes":{"0":{"gridlines":{"color":"#FFFFFF"}}},"legend":{"position":"none"},"series":{"0":{"color":"#002060","dataLabel":"value","annotations":{"textStyle":{"fontSize":7}}}},"useFirstColumnAsDomain":true,"width":700,"is3D":false,"title":"Costi (annui)","titleTextStyle":{"bold":true,"italic":false},"height":369}};

google.visualization.drawChart(j, document.getElementById('chart3-p0532')); 

}

function handleQueryResponse3(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

var datatable=response.getDataTable();



//remissioni annui
var j={"view":{"columns":[{"sourceColumn":0},1]},"dataTable":datatable,"chartType":"ColumnChart","options":{"hAxis":{"textStyle":{"bold":true,"italic":false},"gridlines":{"color":"#FFFFFF"}},"vAxes":{"0":{"gridlines":{"color":"#FFFFFF"}}},"legend":{"position":"none"},"series":{"0":{"color":"#002060","dataLabel":"value"}},"useFirstColumnAsDomain":true,"width":700,"is3D":false,"title":"Remissioni (annue)","chartArea":{"backgroundColor":{"fill":"#FFFFFF"}},"titleTextStyle":{"bold":true,"italic":false},"height":369}};

google.visualization.drawChart(j, document.getElementById('chart2-p0532')); 

}




function handleQueryResponse2(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

var datatable=response.getDataTable();
//trattamenti annui
var j={"view":{"columns":[{"sourceColumn":0},1]},"dataTable":{"rows":[{"c":[{"v":"Anno 0"},{"v":387308.5775346534,"f":"387.309"}]},{"c":[{"v":"Anno 1"},{"v":188502.25222368079,"f":"188.502"}]},{"c":[{"v":"Anno 2"},{"v":111757.74121099873,"f":"111.758"}]},{"c":[{"v":"Anno 3"},{"v":76707.13196390367,"f":"76.707"}]},{"c":[{"v":"Anno 4"},{"v":58045.16152292013,"f":"58.045"}]},{"c":[{"v":"Anno 5"},{"v":46716.144166288665,"f":"46.716"}]},{"c":[{"v":"Anno 6-10 media"},{"v":29872.76830587939,"f":"29.873"}]},{"c":[{"v":"Anno 11-15 media"},{"v":15988.222092761822,"f":"15.988"}]},{"c":[{"v":"Anno 16-20 media"},{"v":9256.379789273395,"f":"9.256"}]},{"c":[{"v":"Anno 21-25 media"},{"v":5584.169708901225,"f":"5.584"}]},{"c":[{"v":"Anno 26-30 media"},{"v":3475.1807881316636,"f":"3.475"}]}],"cols":[{"id":"Col0","label":"","type":"string"},{"pattern":"#,##0","id":"Col1","label":"","type":"number"}]},"chartType":"ColumnChart","options":{"hAxis":{"textStyle":{"bold":true,"italic":false},"gridlines":{"color":"#FFFFFF"}},"vAxes":{"0":{"gridlines":{"color":"#FFFFFF"}}},"legend":{"position":"none"},"series":{"0":{"color":"#002060","dataLabel":"value"}},"useFirstColumnAsDomain":true,"width":700,"is3D":false,"title":"Trattamenti (annui)","chartArea":{"backgroundColor":{"fill":"#FFFFFF"}},"titleTextStyle":{"bold":true,"italic":false},"height":369}}


  google.visualization.drawChart(j, document.getElementById('chart1-p0532')); 

}

function handleQueryResponse1(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

 var datatable = new google.visualization.DataView(response.getDataTable());
  var table = new google.visualization.Table(document.getElementById('dataTable-p0532'));
  table.draw(datatable,{'sort':'disable'});

}


function handleQueryResponse0(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

 var datatable = new google.visualization.DataView(response.getDataTable());
  var table = new google.visualization.Table(document.getElementById('dataTable0-p0532'));
  table.draw(datatable,{'sort':'disable'});

}


drawCharts(data.record,activeSheetName.substring(0,4),activeSheetName);

%>

<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-body">

       <div class="table-responsive">
              <table class="table" >
              <thead>
              Parametri
              </thead>
                             <tbody>
 <%
                     
                  _.each(opzRegParams,function(item){
                            _.each(item,function(e,k){
                             
                              %>
                              
                              <td><%= e.label %>:<%= e.value %>
                                
                           
                               </td> 

                             
                         
                              
                              <%})

                    })
              %>
                            </tbody>
              </table>

      </div>
      <div class="table-responsive">
              <table class="table" >
              <thead>
              Parametri genotipo
              </thead>
                             <tbody>
 <%
                     
                  _.each(opzGenParams,function(item){
                            _.each(item,function(e,k){
                             
                              %>
                              
                              <td><%= e.label %>:
                                
                                <input disabled="disabled"  type="checkbox"  id="<%= k %>" name="<%= k %>"  label="<%= e.label%>" row="<%= e.row%>" col="<%= e.col%>" type="text" <%= e.value!== 'X' ?  '' : 'checked="checked" ' %>></input> 
                               </td> 

                             
                         
                              
                              <%})

                    })
              %>
                            </tbody>
              </table>

      </div>
    </div>
</div>
</div>
</div>

<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
      <div class="panel-body">
        <div id='textNote'><%print(textNote);%></div>
      </div>
    </div>
</div>
</div>

<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-body">
           <div id='dataTable0-p0532' ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
          <div id='dataTable-p0532' ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
</div>
    </div>
</div>

 <div class="row">
    <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-body">
        <div id='chart2-p0532' ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
  </div>

</div>

 <div class="row">
    <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-body">
        <div id='chart4-p0532' ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
  </div>

</div>