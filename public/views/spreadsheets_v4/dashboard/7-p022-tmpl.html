<%

function drawCharts(spreadsheet,activeSheet) {
var activeSheetName=activeSheet;


var query0 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?&headers=0&sheet=OPZ&range=E6:E7&pli=1');

query0.send(handleQueryResponse0);

var query1 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A45:C52&pli=1'); 
query1.send(handleQueryResponse1);


var query3 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A15:H23&pli=1'); 
query3.send(handleQueryResponse3);

var query4 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A25:H33&pli=1'); 
query4.send(handleQueryResponse4);

var query5 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A35:H43&pli=1'); 
query5.send(handleQueryResponse5);

var query6 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A45:D52&pli=1'); 
query6.send(handleQueryResponse6);




}


function handleQueryResponse0(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();

 var datatable = new google.visualization.DataView(response.getDataTable());

  var table = new google.visualization.Table(document.getElementById('OPZ'+activeSheetName));
  table.draw(datatable,{'sort':'disable',cssClassNames: {headerCell: 'googleHeaderCell'}});
}

function handleQueryResponse1(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();
dataTable.setColumnLabel(1,"Terapia");
dataTable.setColumnLabel(2,"Extra Terapia");



var j=
{"view":{"columns":[0,1,2]},"chartName":"Grafico 25","dataTable":dataTable,"options":{ "chartArea": {top: 28,height: '60%'},"hasHiddenData":false,"treatLabelsAsText":false,"vAxes":[{"useFormatFromData":true,"minValue":null,"logScale":false,"maxValue":null,"title":null,"viewWindow":{"min":null,"max":null}},{"useFormatFromData":true,"minValue":null,"logScale":false,"maxValue":null,"viewWindow":{"min":null,"max":null}}],"legend":"bottom","isStacked":true,"legacyScatterChartLabels":true,"title":"Costi medi per paziente per molecola, Valori in €","titleTextStyle":{"color":"#000","bold":true},"hAxis":{"useFormatFromData":true,"textStyle":{"color":"#222","fontSize":"9",textPosition: 'out'},"title":""},"useFirstColumnAsDomain":true,"width":600,"legacyContinuousAxisRemoved":true,"booleanRole":"certainty","height":300},"chartType":"ColumnChart","state":{},"isDefaultVisualization":true};



google.visualization.drawChart(j, document.getElementById('chart1'+activeSheetName)); 

}





function handleQueryResponse3(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();


 var datatable = new google.visualization.DataView(response.getDataTable());
  var table = new google.visualization.Table(document.getElementById('dataTable1'+activeSheetName));
  table.draw(datatable,{'sort':'disable',cssClassNames: {headerCell: 'googleHeaderCell'}});

}


function handleQueryResponse4(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();


 var datatable = new google.visualization.DataView(response.getDataTable());
 // var table = new google.visualization.Table(document.getElementById('dataTable2'+activeSheetName));
 // table.draw(datatable,{'sort':'disable',cssClassNames: {headerCell: 'googleHeaderCell'}});

}

function handleQueryResponse5(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();


 var datatable = new google.visualization.DataView(response.getDataTable());
 // var table = new google.visualization.Table(document.getElementById('dataTable3'+activeSheetName));
 // table.draw(datatable,{'sort':'disable',cssClassNames: {headerCell: 'googleHeaderCell'}});

}

function handleQueryResponse6(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();


 var datatable = new google.visualization.DataView(response.getDataTable());
  var table = new google.visualization.Table(document.getElementById('dataTable4'+activeSheetName));
  table.draw(datatable,{'sort':'disable',cssClassNames: {headerCell: 'googleHeaderCell'}});

}


drawCharts(data.record,activeSheetName);




%>
<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
        <div id='textNote'><%print(textNote);%></div>
      </div>
    </div>
 
</div>

</div>


<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
      <div class="panel-body">
        <div id='OPZ<%=activeSheetName%>'></div>
      </div>
    </div>
</div>
</div>

<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
        <strong>Costi medi per paziente per molecola, Valori in €</strong>
         <div id="dataTable4<%=activeSheetName%>" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>

<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">

         <div id="chart1<%=activeSheetName%>" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
  </div>

</div>


<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
        <strong>Costi medi per paziente schizofrenico, Valori in €</strong>
         <div id="dataTable1<%=activeSheetName%>" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>
<!-- 
<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
         <div id="dataTable2P022" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>

<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
         <div id="dataTable3P022" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>

<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
         <div id="dataTable4P022" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>


-->

