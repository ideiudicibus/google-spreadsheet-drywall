<%


function drawCharts(spreadsheet,activeSheet) {
var activeSheetName=activeSheet;

var query1 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&headers=-1&merge=COLS&range=A6:A9,B6:B9,C6:C9,D6:D9,E6:E9&pli=1'); 

query1.send(handleQueryResponse1);


var query2 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&headers=-1&merge=COLS&range=A6:A9,F6:F9,G6:G9,H6:H9&pli=1'); 

query2.send(handleQueryResponse2);

var query3 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=1&headers=-1&merge=ROWS&range=A6:E6,A10:E10,A11:E11&pli=1'); 
query3.send(handleQueryResponse3);

var query4 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&headers=-1&merge=COLS&range=A7:A9,F7:F9,F17:F19,G7:G9,G17:G19,H7:H9,H17:H19&pli=1'); 

query4.send(handleQueryResponse4);


var query5 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&range=A6:H19&pli=1'); 
query5.send(handleQueryResponse5);

var query6 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&transpose=0&range=A21:H29&pli=1'); 
query6.send(handleQueryResponse6);

}


function handleQueryResponse1(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();

var j= {"chartType":"ColumnChart","view":{"columns":[{"sourceColumn":0},1,2,3,4]},"dataTable":dataTable,"options":{"title":"Budget Impact.Valori in â‚¬.","legend":{"position":"bottom"},"width":600,"height":400,"is3D":false,"useFirstColumnAsDomain":true}};
google.visualization.drawChart(j, document.getElementById('chart1P019')); 

}

function handleQueryResponse2(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();

var j={"chartType":"ColumnChart","view":{"columns":[{"sourceColumn":0},1,2,3]},"dataTable":dataTable,"options":{"title":"Budget impact - Var. %.","width":600,"height":400,"legend":{"position":"bottom"},"is3D":false,"useFirstColumnAsDomain":true}};
google.visualization.drawChart(j, document.getElementById('chart2P019')); 

}


function handleQueryResponse3(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();

var j={"chartType":"ColumnChart","view":{"columns":[{"sourceColumn":0},1,2]},"dataTable":dataTable,"options":{"chartArea":{"top":"10%","left":"10%","width":"80%","height":"80%"},"title":"Composizione costi.","width":600,"height":400,"legend":{"position":"bottom",maxLines: 10},"is3D":false,"useFirstColumnAsDomain":true,"isStacked":true}};


google.visualization.drawChart(j, document.getElementById('chart3P019')); 

}

function handleQueryResponse4(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();

dataTable.setColumnLabel(1,"Sim. Base t1/t0");
dataTable.setColumnLabel(2,"Sim. a demogr. cost. t1/t0");
dataTable.setColumnLabel(3,"Sim. Base t2/t1");




var j = {"view":{"columns":[{"sourceColumn":0},1,2,3]},"dataTable":dataTable,"options":{"legend":{"position":"bottom"},"useFirstColumnAsDomain":true,"width":600,"is3D":false,"chartArea":{"top":"10%","left":"10%","width":"80%","height":"80%"},"title":"Budget impact - Val. %","titleTextStyle":{"bold":true,"italic":false},"height":400},"chartType":"ColumnChart"};


//google.visualization.drawChart(j, document.getElementById('chart4P019')); 

}


function handleQueryResponse5(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();


 var datatable = new google.visualization.DataView(response.getDataTable());
 datatable.setRows([0,1,2,3,4]);
  var table = new google.visualization.Table(document.getElementById('dataTable1P019'));
  table.draw(datatable,{'sort':'disable'});

}

function handleQueryResponse6(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();


 var datatable = new google.visualization.DataView(response.getDataTable());
 datatable.setRows([0,1,2,3,4]);
  var table = new google.visualization.Table(document.getElementById('dataTable2P019'));
  table.draw(datatable,{'sort':'disable'});

}



drawCharts(data.record,activeSheetName);

%>
<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
        <div id='textNote'><%print(textNote);%></div>
      </div>
    </div>
 
</div>
  

</div>

<div class="row">
<div class="col-md-12">
    <div class="panel panel-default">
      <i class="fa fa-asterisk red-star pull-right" >&nbsp;</i>
      <div class="panel-body">
        <div id="chart1P019">
          <div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
  </div>

</div>
<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
          <i class="fa fa-asterisk green-star pull-right" >&nbsp;</i>
        <div class="panel-body">
        <div id="chart2P019" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>

<div class="row">
    <div class="col-md-12">
    <div class="panel panel-default">
      <i class="fa fa-asterisk blue-star pull-right" >&nbsp;</i>
      <div class="panel-body">
        <div id="chart3P019" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
  </div>
  </div>
<!--
  <div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
          <i class="fa fa-asterisk yellow-star pull-right" >&nbsp;</i>
        <div class="panel-body">
        <div id="chart4P019" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>
-->

<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-body">
        <div id="dataTable1P019" >
          <div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-body">
        <div id="dataTable2P019" >
          <div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div>
        </div>
      </div>
    </div>
  </div>
</div>




