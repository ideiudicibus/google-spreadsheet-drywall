<%

function drawCharts(spreadsheet,activeSheet) {
var activeSheetName=activeSheet;

var query1 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A4:H16&pli=1'); 
query1.send(handleQueryResponse1);

function handleQueryResponse1(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var data_table=response.getDataTable();

 var datatable = new google.visualization.DataView(data_table);
  var table = new google.visualization.Table(document.getElementById('dataTable1-P021'));
  table.draw(datatable,{'sort':'disable'});

}



var query2 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A16:H24&pli=1'); 
query2.send(handleQueryResponse2);

function handleQueryResponse2(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var data_table=response.getDataTable();

 var datatable = new google.visualization.DataView(data_table);
  var table = new google.visualization.Table(document.getElementById('dataTable2-P021'));
  table.draw(datatable,{'sort':'disable'});

}

var query3 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A11:A16,B11:B16,C11:C16,D11:D16,E11:E16&pli=1'); 
query3.send(handleQueryResponse3);


function handleQueryResponse3(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
  var dataTable=response.getDataTable();
dataTable.setColumnLabel(1,"t0");
dataTable.setColumnLabel(2,"t1");
dataTable.setColumnLabel(3,"t2");
dataTable.setColumnLabel(4,"t3");

var j = {"view":{"columns":[{"sourceColumn":0},1,2,3,4]},"dataTable":dataTable,"options":{"hAxis":{"textStyle":{"fontSize":8,"bold":true,"italic":false},"gridlines":{"color":"#FFFFFF"}},"vAxes":{"0":{"gridlines":{"color":"#B7B7B7"},"viewWindow":{"min":100}}},"legend":{"position":"bottom"},"series":{"0":{"color":"#595959"},"1":{"color":"#00B0F0"},"2":{"color":"#0070C0"},"3":{"color":"#002060"}},"useFirstColumnAsDomain":true,"width":699,"is3D":false,"chartArea":{"backgroundColor":{"fill":"#FFFFFF"}},"title":"Impatto su outcome e","titleTextStyle":{"bold":true,"italic":false},"height":380},"chartType":"ColumnChart"};





google.visualization.drawChart(j, document.getElementById('chart1-P021')); 

}

//


var query4 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A4:A10,F4:F10,G4:G10,H4:H10&pli=1'); 
query4.send(handleQueryResponse4);


function handleQueryResponse4(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
  var dataTable=response.getDataTable();
dataTable.setColumnLabel(1,"t1/t0");
dataTable.setColumnLabel(2,"t2/t1");
dataTable.setColumnLabel(3,"t3/t2");

var j ={"view":{"columns":[{"sourceColumn":0},1,2,3]},"dataTable":dataTable,"options":{"hAxis":{"textStyle":{"fontSize":8,"bold":true,"italic":false},"gridlines":{"color":"#FFFFFF"}},"vAxes":{"0":{"gridlines":{"color":"#B7B7B7"}}},"legend":{"position":"bottom"},"series":{"0":{"color":"#00B0F0"},"1":{"color":"#0070C0"},"2":{"color":"#002060"}},"useFirstColumnAsDomain":true,"width":699,"is3D":false,"chartArea":{"backgroundColor":{"fill":"#FFFFFF"}},"title":"Impatto % su outcome e utilizzo dei servizi","titleTextStyle":{"bold":true,"italic":false},"height":380},"chartType":"ColumnChart"};

google.visualization.drawChart(j, document.getElementById('chart2-P021')); 

}


var query5 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A5:A10,F5:F10,F19:F24,G5:G10,G19:G24,H5:H10,H19:H24&pli=1'); 
query5.send(handleQueryResponse5);


function handleQueryResponse5(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
  var dataTable=response.getDataTable();
  dataTable.setColumnLabel(1,"Sim. Base t1/t0");
  dataTable.setColumnLabel(2,"Sim. Base t2/t1");
  dataTable.setColumnLabel(3,"Sim. Base t3/t2");
  dataTable.setColumnLabel(4,"Sim. a Demogr. cost t1/t0");
  dataTable.setColumnLabel(5,"Sim. a Demogr. cost t2/t1");
  dataTable.setColumnLabel(6,"Sim. a Demogr. cost t3/t2");
 

var j ={"view":{"columns":[{"sourceColumn":0},1,2,3,4,5,6]},"dataTable":dataTable,"chartType":"ColumnChart","options":{"hAxis":{"textStyle":{"fontSize":8,"bold":true,"italic":false},"gridlines":{"color":"#FFFFFF"}},"vAxes":{"0":{"gridlines":{"color":"#B7B7B7"}}},"legend":{"position":"bottom", maxLines: 2},"series":{"0":{"color":"#00B0F0"},"1":{"color":"#50FB33"},"2":{"color":"#0070C0"},"3":{"color":"#92D050"},"4":{"color":"#002060"},"5":{"color":"#00B050"}},"useFirstColumnAsDomain":true,"width":699,"is3D":false,"title":"Impatto su outcome e utilizzo servizi ","chartArea":{"backgroundColor":{"fill":"#FFFFFF"}},"titleTextStyle":{"bold":true,"italic":false},"height":373}};



google.visualization.drawChart(j, document.getElementById('chart3-P021')); 

}


}
drawCharts(data.record,activeSheetName);
%>
<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
        <div id='textNote'><%print(textNote)%></div>
      </div>
    </div>
 </div>
</div>


<div class="row">
  <div class="col-md-12">
      <div class="panel panel-default">
      <i class="fa pull-right" >&nbsp;</i>
      <div class="panel-body">
        <div id="chart1-P021" >
          <div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
    </div>
 </div>
<div class="row">
   <div class="col-md-12">
      <div class="panel panel-default">
      <i class="fa pull-right" >&nbsp;</i>
      <div class="panel-body">
        <div id="chart2-P021" >
          <div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
    </div>
 </div>
<div class="row">
    <div class="col-md-12">
      <div class="panel panel-default">
      <i class="fa pull-right" >&nbsp;</i>
      <div class="panel-body">
        <div id="chart3-P021" >
          <div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
    </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-body">
        <div id="dataTable1-P021" >
          <div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div>
        </div>
      </div>
    </div>
  </div>

</div>

<div class="row">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-body">
        <div id="dataTable2-P021" >
          <div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div>
        </div>
      </div>
    </div>
  </div>

</div>