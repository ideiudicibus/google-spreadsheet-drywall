<%

function drawCharts(spreadsheet,activeSheet) {
var activeSheetName=activeSheet;

var query1 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A19:A25,B19:B25&pli=1'); 
query1.send(handleQueryResponse1);


var query2 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A29:A35,B29:B35&pli=1'); 
query2.send(handleQueryResponse2);


var query3 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A5:H8&pli=1'); 
query3.send(handleQueryResponse3);

var query4 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A17:H20&pli=1'); 
query4.send(handleQueryResponse4);

var query5 = new google.visualization.Query(
      'https://docs.google.com/spreadsheets/d/'+spreadsheet.googleId+'/gviz/tq?sheet='+activeSheetName+'&range=A27:H30&pli=1'); 
query5.send(handleQueryResponse5);




}


function handleQueryResponse1(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();
//dataTable.setColumnLabel(1,"Costi Ivabradina on-top");
//dataTable.setColumnLabel(2,"Costi Terapia standard");



var j = {"view":{"columns":[{"sourceColumn":0},1]},"dataTable":dataTable,"chartType":"ColumnChart","options":{"hAxis":{"textStyle":{"color":"#002060","fontSize":8,"bold":false,"italic":false},"gridlines":{"color":"#FFFFFF"}},"vAxes":{"0":{"textStyle":{"color":"#002060","fontSize":9,"bold":false,"italic":false},"gridlines":{"color":"#D9D9D9"}}},"legend":{"position":"none"},"series":{"0":{"color":"#4F81BD"}},"useFirstColumnAsDomain":true,"width":429,"is3D":false,"title":"Costi terapie pro-capite (\u20ac)","chartArea":{"backgroundColor":{"fill":"#FFFFFF"}},"titleTextStyle":{"color":"#002060","fontSize":18,"bold":true,"italic":false},"height":273}};





google.visualization.drawChart(j, document.getElementById('chart1P022')); 

}


function handleQueryResponse2(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();
//dataTable.setColumnLabel(1,"Costi extra ter. Ivabradina on-top");
//dataTable.setColumnLabel(2,"Costi extra Ter. standard");



var j = {"view":{"columns":[{"sourceColumn":0},1]},"dataTable":dataTable,"chartType":"ColumnChart","options":{"hAxis":{"textStyle":{"color":"#002060","fontSize":8,"bold":false,"italic":false},"gridlines":{"color":"#FFFFFF"}},"vAxes":{"0":{"textStyle":{"color":"#595959","fontSize":9,"bold":false,"italic":false},"gridlines":{"color":"#D9D9D9"}}},"legend":{"position":"none"},"series":{"0":{"color":"#4F81BD"}},"useFirstColumnAsDomain":true,"width":416,"is3D":false,"title":"Costi extra terapie pro-capite (\u20ac)","chartArea":{"backgroundColor":{"fill":"#FFFFFF"}},"titleTextStyle":{"color":"#002060","fontSize":18,"bold":true,"italic":false},"height":287}};





google.visualization.drawChart(j, document.getElementById('chart2P022')); 

}





function handleQueryResponse3(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();


 var datatable = new google.visualization.DataView(response.getDataTable());
  var table = new google.visualization.Table(document.getElementById('dataTable1P022'));
  table.draw(datatable,{'sort':'disable'});

}


function handleQueryResponse4(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();


 var datatable = new google.visualization.DataView(response.getDataTable());
  var table = new google.visualization.Table(document.getElementById('dataTable2P022'));
  table.draw(datatable,{'sort':'disable'});

}

function handleQueryResponse5(response) {
   
  if (response.isError()) {
    alertify.error('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }
var dataTable=response.getDataTable();


 var datatable = new google.visualization.DataView(response.getDataTable());
  var table = new google.visualization.Table(document.getElementById('dataTable3P022'));
  table.draw(datatable,{'sort':'disable'});

}

drawCharts(data.record,activeSheetName);

%>
<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
        <div id='textNote'><%print(textNote);%></div>
      </div>
    </div>
 
</div>

</div>

<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
         <div id="chart1P022" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>

<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
         <div id="chart2P022" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
  </div>

</div>


<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
         <div id="dataTable1P022" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>

<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
         <div id="dataTable2P022" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>

<div class="row">
  <div class="col-md-12">
        <div class="panel panel-default">
        <div class="panel-body">
         <div id="dataTable3P022" ><div id="ajax-spinner" style="z-index: 100;"><img src="/media/ajax-pulse.gif"/></div></div>
      </div>
    </div>
 
</div>
</div>

